<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#0c1a2e">
    <meta name="description" content="Hamilton Masjid Prayer Times - Hamilton, New Zealand">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Ramadan 1447H - Hamilton Masjid Prayer Times">
    <meta property="og:description" content="Suhoor, Iftar & all prayer times for Ramadan 2026. Hamilton Masjid, New Zealand.">
    <meta property="og:image" content="https://nextwave-nz.github.io/prayer-times/Hamilton/og-image.png">
    <meta property="og:url" content="https://nextwave-nz.github.io/prayer-times/Hamilton/">
    <meta property="og:site_name" content="Hamilton Masjid Prayer Times">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Ramadan 1447H - Hamilton Masjid Prayer Times">
    <meta name="twitter:description" content="Suhoor, Iftar & all prayer times for Ramadan 2026. Hamilton Masjid, New Zealand.">
    <meta name="twitter:image" content="https://nextwave-nz.github.io/prayer-times/Hamilton/og-image.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Hamilton Masjid">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect fill='%230c1a2e' width='180' height='180' rx='40'/><text x='90' y='125' font-size='100' text-anchor='middle' fill='%23d4a843'>üåô</text></svg>">
    <link rel="manifest" href="manifest.json">
    <title>Hamilton Masjid - Prayer Times</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=DM+Sans:wght@400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
    <style>
        :root{--night:#0c1a2e;--night-light:#132240;--gold:#d4a843;--gold-light:#e8c876;--gold-dim:#a8832f;--cream:#f5f0e8;--teal:#2a9d8f;--teal-dark:#1f7a6f;--coral:#e07a5f;--coral-dark:#c4613f;--text-dark:#1a1a2e;--text-mid:#4a4a6a;--text-light:#8a8aa0;--card-shadow:0 4px 24px rgba(12,26,46,0.08);--card-shadow-hover:0 8px 40px rgba(12,26,46,0.14)}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'DM Sans',-apple-system,BlinkMacSystemFont,sans-serif;background:var(--cream);min-height:100vh;color:var(--text-dark);-webkit-font-smoothing:antialiased}
        .hero{background:var(--night);color:#fff;text-align:center;padding:clamp(32px,5.5vh,60px) 16px clamp(24px,4vh,48px);position:relative;overflow:hidden}
        .hero::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(ellipse at 20% 50%,rgba(212,168,67,.08) 0%,transparent 60%),radial-gradient(ellipse at 80% 20%,rgba(42,157,143,.06) 0%,transparent 50%);pointer-events:none}
        .hero-stars{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;pointer-events:none}
        .star{position:absolute;width:2px;height:2px;background:rgba(255,255,255,.6);border-radius:50%;animation:twinkle 3s ease-in-out infinite}
        @keyframes twinkle{0%,100%{opacity:.3}50%{opacity:1}}
        .hero-crescent{font-size:clamp(2.4em,5.5vw,4em);filter:drop-shadow(0 0 15px rgba(212,168,67,.4));animation:gentleFloat 6s ease-in-out infinite;line-height:1;display:block;margin-bottom:clamp(8px,1.5vh,16px)}
        @keyframes gentleFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-4px)}}
        .hero h1{font-family:'DM Serif Display',serif;font-size:clamp(1.8em,5vw,3.2em);letter-spacing:.02em;color:var(--gold-light);position:relative;margin-bottom:clamp(4px,.8vh,8px)}
        .hero-ramadan{font-family:'Amiri',serif;font-size:clamp(1.05em,2.2vw,1.5em);color:rgba(255,255,255,.55);margin-bottom:clamp(10px,2vh,20px);letter-spacing:.03em}
        .hero-ramadan.hide{display:none}
        .hero-info{display:flex;align-items:center;justify-content:center;gap:8px;flex-wrap:wrap;font-size:clamp(.72em,1.6vw,.9em);color:rgba(255,255,255,.45)}
        .hero-info .sep{opacity:.3}
        .hero-info strong{color:var(--gold-light);font-weight:600}
        .main-content{max-width:1100px;margin:0 auto;padding:16px 14px 40px}
        .today-card{background:#fff;border-radius:18px;padding:18px 16px;box-shadow:var(--card-shadow);margin-bottom:14px;position:relative;overflow:hidden;border:1px solid rgba(0,0,0,.04)}
        .today-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--gold),var(--teal),var(--gold))}
        .today-top-row{margin-bottom:12px}
        .today-label{font-size:.68em;text-transform:uppercase;letter-spacing:.12em;color:var(--teal);font-weight:700}
        .today-day-title{font-family:'DM Serif Display',serif;font-size:1.25em;color:var(--text-dark);margin-top:2px}
        .today-date-text{color:var(--text-light);font-size:.8em;margin-top:1px}
        .today-hero-times{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:12px}
        .hero-time-box{padding:14px 8px;border-radius:12px;text-align:center}
        .hero-time-box.suhoor-box{background:linear-gradient(135deg,#e8f4f8,#d1ecf1);border:1px solid rgba(42,157,143,.12)}
        .hero-time-box.iftar-box{background:linear-gradient(135deg,#fdf2e9,#fae5d3);border:1px solid rgba(224,122,95,.12)}
        .hero-time-box .ht-label{font-size:.6em;text-transform:uppercase;letter-spacing:.1em;font-weight:700;margin-bottom:3px}
        .suhoor-box .ht-label{color:var(--teal-dark)} .iftar-box .ht-label{color:var(--coral-dark)}
        .hero-time-box .ht-time{font-family:'DM Serif Display',serif;font-size:clamp(1.7em,5vw,2.4em);line-height:1}
        .suhoor-box .ht-time{color:var(--teal)} .iftar-box .ht-time{color:var(--coral)}
        .hero-time-box .ht-suffix{font-size:.6em;opacity:.6;margin-top:1px}
        .hero-time-box.fasting-box{background:linear-gradient(135deg,#ede7f6,#d1c4e9);border:1px solid rgba(103,58,183,.12)}
        .fasting-box .ht-label{color:#5e35b1} .fasting-box .ht-time{color:#5e35b1;font-size:clamp(1.2em,3.5vw,1.8em)} .fasting-box .ht-suffix{color:#7e57c2}
        .ramadan-only{display:grid} .ramadan-only.hide{display:none}
        .countdown-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
        .countdown-grid.normal-mode{grid-template-columns:1fr}
        .cd-box{background:var(--cream);border-radius:10px;padding:10px 8px;text-align:center;border:1px solid rgba(0,0,0,.04)}
        .cd-box .cd-label{font-size:.58em;text-transform:uppercase;letter-spacing:.08em;color:var(--text-light);font-weight:600;margin-bottom:3px}
        .cd-box .cd-value{font-family:'DM Sans',monospace;font-size:1.1em;font-weight:700;color:var(--night)}
        .cd-box .cd-sub{font-size:.62em;color:var(--text-light);margin-top:1px}
        .cd-box.cd-iftar{background:linear-gradient(135deg,var(--coral),var(--coral-dark))}
        .cd-box.cd-iftar .cd-label,.cd-box.cd-iftar .cd-value,.cd-box.cd-iftar .cd-sub{color:#fff}
        .special-notice{margin-top:10px;padding:7px 12px;border-radius:8px;text-align:center;font-weight:600;font-size:.8em;background:linear-gradient(135deg,#fdf2e9,#fae5d3);color:var(--coral-dark);display:none}
        .special-notice.show{display:block}
        .eid-info-cards{display:flex;gap:8px;margin-bottom:14px}
        .eid-card{flex:1;display:flex;align-items:center;gap:10px;padding:12px 14px;border-radius:12px;font-size:.82em;line-height:1.4;color:var(--text-dark)}
        .eid-card .eid-icon{font-size:1.3em;flex-shrink:0}
        .eid-card .eid-sub{font-size:.85em;color:var(--text-light);font-style:italic}
        .eid-card.zakat-card{background:linear-gradient(135deg,#e8f5e9,#c8e6c9);border:1px solid rgba(76,175,80,.15)}
        .eid-card.eid-salaat-card{background:linear-gradient(135deg,#e3f2fd,#bbdefb);border:1px solid rgba(33,150,243,.12)}
        @media(max-width:480px){.eid-info-cards{flex-direction:column}}
        .action-row{display:flex;gap:8px;margin-bottom:14px}
        .action-pill{flex:1;display:flex;align-items:center;justify-content:center;gap:7px;padding:12px 14px;border-radius:12px;border:none;font-family:'DM Sans',sans-serif;font-size:.82em;font-weight:600;cursor:pointer;transition:all .25s ease;text-decoration:none;color:inherit}
        .action-pill:active{transform:scale(.97)}
        .action-pill.ap-calendar{background:var(--night);color:var(--gold-light);box-shadow:0 3px 12px rgba(12,26,46,.18)}
        .action-pill.ap-share{background:#fff;color:var(--text-mid);border:1.5px solid rgba(0,0,0,.08);box-shadow:0 2px 8px rgba(0,0,0,.04)}
        .action-pill.ap-install{background:linear-gradient(135deg,var(--teal),var(--teal-dark));color:#fff;box-shadow:0 3px 12px rgba(42,157,143,.2)}
        /* Notification Banner */
        .notif-banner{display:flex;align-items:center;gap:12px;background:var(--night-light);border:1.5px solid rgba(212,168,67,.15);border-radius:14px;padding:14px 16px;margin-bottom:14px;cursor:pointer;transition:all .25s ease;user-select:none;-webkit-tap-highlight-color:transparent}
        .notif-banner:active{transform:scale(.98);background:rgba(19,34,64,.9)}
        .notif-banner.nb-enabled{border-color:rgba(42,157,143,.25);background:rgba(42,157,143,.08)}
        .notif-banner.nb-hidden{display:none}
        .nb-icon{font-size:1.4em;flex-shrink:0;filter:drop-shadow(0 0 6px rgba(212,168,67,.4))}
        .nb-text{flex:1}
        .nb-title{font-weight:600;font-size:.88em;color:var(--gold-light)}
        .notif-banner.nb-enabled .nb-title{color:var(--teal)}
        .nb-sub{font-size:.72em;color:rgba(255,255,255,.4);margin-top:2px}
        .notif-banner.nb-enabled .nb-sub{color:var(--text-light)}
        .nb-arrow{font-size:1.3em;color:rgba(255,255,255,.2);font-weight:300}
        .controls-row{display:flex;gap:8px;margin-bottom:14px;align-items:stretch}
        .view-controls{display:flex;gap:3px;background:#fff;padding:3px;border-radius:10px;box-shadow:var(--card-shadow);border:1px solid rgba(0,0,0,.04);flex-shrink:0}
        .view-btn{padding:9px 16px;border:none;background:transparent;border-radius:8px;font-family:'DM Sans',sans-serif;font-weight:600;font-size:.8em;color:var(--text-mid);cursor:pointer;transition:all .25s ease}
        .view-btn.active{background:var(--night);color:var(--gold-light);box-shadow:0 2px 8px rgba(12,26,46,.12)}
        .legend{display:flex;gap:6px;flex-wrap:wrap;align-items:center;flex:1;justify-content:flex-end}
        .legend-chip{display:flex;align-items:center;gap:4px;font-size:.68em;font-weight:600;color:var(--text-mid);background:#fff;padding:6px 10px;border-radius:100px;border:1px solid rgba(0,0,0,.05);cursor:pointer;transition:all .2s ease;user-select:none;-webkit-tap-highlight-color:transparent;white-space:nowrap}
        .legend-chip:active{transform:scale(.95)}
        .legend-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
        .card-view,.table-view{display:none} .card-view.active,.table-view.active{display:block}
        .day-card{background:#fff;border-radius:14px;margin-bottom:8px;overflow:hidden;box-shadow:0 2px 10px rgba(12,26,46,.04);border:1px solid rgba(0,0,0,.04)}
        .day-card.is-today{border:2px solid var(--gold);box-shadow:0 4px 20px rgba(212,168,67,.12)}
        .day-card.is-odd .card-header{border-left:4px solid #9b59b6;background:rgba(155,89,182,.04)}
        .day-card.is-last-ten .card-header{border-left:4px solid var(--gold);background:rgba(212,168,67,.04)}
        .day-card.is-today .card-header{border-left:4px solid var(--coral)}
        .card-header{padding:11px 14px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent}
        .card-header:active{background:var(--cream)}
        .card-header-left{display:flex;align-items:center;gap:10px}
        .card-day-num{width:34px;height:34px;display:flex;align-items:center;justify-content:center;border-radius:8px;font-weight:700;font-size:.88em;background:var(--cream);color:var(--text-dark)}
        .day-card.is-today .card-day-num{background:var(--coral);color:#fff}
        .day-card.is-odd .card-day-num{background:#f3e8ff;color:#7c3aed}
        .card-header-info .card-title{font-weight:600;font-size:.85em;color:var(--text-dark)}
        .card-header-info .card-subtitle{font-size:.72em;color:var(--text-light);margin-top:1px}
        .card-iftar-quick{text-align:right}
        .card-iftar-quick .ciq-label{font-size:.58em;text-transform:uppercase;letter-spacing:.06em;color:var(--text-light);font-weight:600}
        .card-iftar-quick .ciq-time{font-family:'DM Serif Display',serif;font-size:1.1em;color:var(--coral)}
        .chevron{color:var(--text-light);transition:transform .3s ease;font-size:.75em;margin-left:6px}
        .day-card.expanded .chevron{transform:rotate(180deg)}
        .card-body{display:none;padding:0 14px 14px;animation:slideDown .3s ease}
        .day-card.is-today .card-body,.day-card.expanded .card-body{display:block}
        @keyframes slideDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
        .prayer-pills{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
        .prayer-pill{padding:9px 5px;border-radius:8px;text-align:center;background:var(--cream)}
        .prayer-pill .pp-name{font-size:.6em;text-transform:uppercase;letter-spacing:.05em;color:var(--text-light);font-weight:600;margin-bottom:2px}
        .prayer-pill .pp-time{font-weight:700;font-size:.95em;color:var(--text-dark)}
        .prayer-pill.pill-suhoor{background:#e8f8f5} .prayer-pill.pill-suhoor .pp-time{color:var(--teal)}
        .prayer-pill.pill-iftar{grid-column:1/-1;background:linear-gradient(135deg,var(--coral),#d45d43);padding:12px 8px}
        .prayer-pill.pill-iftar .pp-name{color:rgba(255,255,255,.85);font-size:.65em}
        .prayer-pill.pill-iftar .pp-time{color:#fff;font-family:'DM Serif Display',serif;font-size:1.5em}
        .table-wrapper{background:#fff;border-radius:14px;overflow:hidden;box-shadow:var(--card-shadow);border:1px solid rgba(0,0,0,.04)}
        table{width:100%;border-collapse:collapse;font-size:.88em}
        thead{background:var(--night);color:#fff;position:sticky;top:0;z-index:10}
        th{padding:11px 6px;text-align:center;font-weight:600;font-size:.78em;letter-spacing:.03em;white-space:nowrap}
        th .th-sub{display:block;font-weight:400;opacity:.6;font-size:.85em;margin-top:2px}
        th.th-suhoor{background:rgba(42,157,143,.3)} th.th-iftar{background:rgba(224,122,95,.35)}
        td{padding:9px 6px;text-align:center;border-bottom:1px solid rgba(0,0,0,.04)}
        td small{font-size:.7em;opacity:.5;font-weight:400;text-transform:uppercase;margin-left:1px}
        tbody tr:hover{background:rgba(0,0,0,.02)}
        tr.row-today{background:linear-gradient(90deg,#fef3cd,#fdf6e3,#fef3cd)!important}
        tr.row-today td{font-weight:700;color:var(--text-dark);border-top:2px solid var(--gold);border-bottom:2px solid var(--gold)}
        tr.row-today td:first-child{border-left:4px solid var(--gold)}
        tr.row-today td:last-child{border-right:4px solid var(--gold)}
        tr.row-last-ten{background:rgba(212,168,67,.12)} tr.row-odd{background:rgba(155,89,182,.12)}
        tr.row-halfway{background:rgba(42,157,143,.12)}
        .td-day{font-weight:700;color:var(--night)}
        .td-suhoor{background:rgba(42,157,143,.07);color:var(--teal-dark);font-weight:600}
        tr.row-today .td-suhoor{background:rgba(42,157,143,.2)}
        .td-iftar{background:rgba(224,122,95,.07);color:var(--coral-dark);font-weight:700;font-size:1.05em}
        tr.row-today .td-iftar{background:rgba(224,122,95,.22)}
        .desktop-table{display:block} .mobile-table{display:none}
        @media(max-width:768px){
            .desktop-table{display:none} .mobile-table{display:block}
            .mobile-table table{font-size:.7em;table-layout:fixed;width:100%}
            .mobile-table th{padding:8px 2px;font-size:.68em;letter-spacing:0;line-height:1.3}
            .mobile-table td{padding:7px 2px;font-size:.78em;white-space:nowrap}
            .mobile-table .mob-date{font-size:.62em;color:var(--text-light);display:block;line-height:1.2;margin-top:1px}
        }
        .today-detail-row td{padding:0!important;border:none!important}
        .today-detail-card{background:linear-gradient(135deg,#fffbf0,#fef6e6);padding:10px;margin:3px 0 6px;border-radius:10px;border:1.5px solid var(--gold)}
        .today-detail-card .tdc-title{font-size:.65em;text-transform:uppercase;letter-spacing:.08em;color:var(--gold-dim);font-weight:700;margin-bottom:5px;text-align:center}
        .tdc-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:4px}
        .tdc-item{text-align:center;background:#fff;border-radius:6px;padding:6px 3px;border:1px solid rgba(0,0,0,.04)}
        .tdc-item .tdc-label{font-size:.55em;text-transform:uppercase;letter-spacing:.04em;color:var(--text-light);font-weight:600;margin-bottom:1px}
        .tdc-item .tdc-time{font-weight:700;font-size:.82em;color:var(--text-dark)}
        .tdc-item.tdc-suhoor{background:#e8f8f5} .tdc-item.tdc-suhoor .tdc-time{color:var(--teal)}
        .tdc-item.tdc-iftar{background:linear-gradient(135deg,#fde8e2,#fdd8ce)} .tdc-item.tdc-iftar .tdc-time{color:var(--coral-dark);font-size:.9em}
        .dua-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:12px;margin-top:20px}
        .dua-card{background:#fff;border-radius:14px;padding:18px;box-shadow:var(--card-shadow);border:1px solid rgba(0,0,0,.04);border-top:3px solid var(--gold)}
        .dua-card h3{font-family:'DM Serif Display',serif;font-size:1em;color:var(--night);margin-bottom:10px}
        .dua-arabic{font-family:'Amiri',serif;font-size:1.2em;text-align:center;color:var(--night);direction:rtl;line-height:2;padding:12px;background:var(--cream);border-radius:8px;margin-bottom:8px}
        .dua-translit{text-align:center;font-style:italic;color:var(--text-light);font-size:.82em;margin-bottom:5px}
        .dua-meaning{text-align:center;color:var(--text-mid);font-size:.78em;line-height:1.5}
        .info-section{background:#fff;border-radius:14px;padding:18px;margin-top:18px;box-shadow:var(--card-shadow);border:1px solid rgba(0,0,0,.04)}
        .info-section h4{font-family:'DM Serif Display',serif;font-size:1em;color:var(--night);margin-bottom:10px}
        .info-list{list-style:none;margin:0;padding:0}
        .info-list li{padding:6px 0;font-size:.82em;color:var(--text-mid);line-height:1.4;border-bottom:1px solid rgba(0,0,0,.04);display:flex;align-items:flex-start;gap:8px}
        .info-list li:last-child{border:none}
        .info-list .li-icon{flex-shrink:0;width:20px;height:20px;background:var(--cream);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.6em;margin-top:1px}
        .footer{background:var(--night);color:#fff;text-align:center;padding:24px 16px;margin-top:28px}
        .footer-mubarak{font-family:'Amiri',serif;font-size:1.3em;color:var(--gold-light);margin-bottom:4px}
        .footer-dua{font-size:.82em;opacity:.6;margin-bottom:14px}
        .footer-source{font-size:.72em;opacity:.4;padding-top:12px;border-top:1px solid rgba(255,255,255,.1)}
        .scroll-top-btn{position:fixed;bottom:18px;right:18px;width:42px;height:42px;background:var(--night);color:var(--gold-light);border:none;border-radius:50%;font-size:1.1em;cursor:pointer;box-shadow:0 4px 16px rgba(12,26,46,.3);z-index:99;opacity:0;transform:translateY(10px);transition:all .3s ease;display:flex;align-items:center;justify-content:center}
        .scroll-top-btn.show{opacity:1;transform:translateY(0)}
        .install-banner{background:var(--teal);color:#fff;padding:9px 14px;text-align:center;font-weight:600;font-size:.78em;cursor:pointer;display:none} .install-banner.show{display:block}
        .toast{position:fixed;bottom:65px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--night);color:#fff;padding:10px 18px;border-radius:10px;font-size:.82em;font-weight:500;box-shadow:0 8px 32px rgba(0,0,0,.2);opacity:0;transition:all .3s ease;z-index:200;pointer-events:none;max-width:90vw;text-align:center}
        .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
        /* Notification prompt */
        .notif-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:300;display:none;align-items:center;justify-content:center;padding:20px}
        .notif-overlay.show{display:flex}
        .notif-modal{background:#fff;border-radius:20px;padding:28px 24px;max-width:360px;width:100%;box-shadow:0 20px 60px rgba(0,0,0,.3);text-align:center}
        .notif-modal h3{font-family:'DM Serif Display',serif;font-size:1.2em;color:var(--night);margin-bottom:8px}
        .notif-modal p{font-size:.85em;color:var(--text-mid);line-height:1.5;margin-bottom:18px}
        .notif-modal .notif-icon{font-size:2.5em;margin-bottom:12px;display:block}
        .notif-options{display:flex;flex-direction:column;gap:8px;margin-bottom:14px}
        .notif-opt{display:flex;align-items:center;gap:10px;padding:10px 14px;background:var(--cream);border-radius:10px;cursor:pointer;border:2px solid transparent;transition:all .2s}
        .notif-opt.selected{border-color:var(--teal);background:#e8f8f5}
        .notif-opt input{display:none}
        .notif-check{width:22px;height:22px;border:2px solid #ccc;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.75em;flex-shrink:0;transition:all .2s}
        .notif-opt.selected .notif-check{background:var(--teal);border-color:var(--teal);color:#fff}
        .notif-opt-text{font-size:.85em;font-weight:600;color:var(--text-dark)}
        .notif-btns{display:flex;gap:8px}
        .notif-btn{flex:1;padding:12px;border-radius:10px;font-family:'DM Sans',sans-serif;font-weight:600;font-size:.88em;cursor:pointer;border:none;transition:all .2s}
        .notif-btn.primary{background:var(--night);color:var(--gold-light)}
        .notif-btn.secondary{background:var(--cream);color:var(--text-mid)}
        .notif-btn:active{transform:scale(.97)}
        /* Install Instructions Modal */
        .install-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:300;display:none;align-items:center;justify-content:center;padding:20px}
        .install-overlay.show{display:flex}
        .install-modal{background:#fff;border-radius:20px;padding:28px 24px;max-width:380px;width:100%;box-shadow:0 20px 60px rgba(0,0,0,.3);text-align:center}
        .install-modal h3{font-family:'DM Serif Display',serif;font-size:1.2em;color:var(--night);margin-bottom:12px}
        .install-modal .im-icon{font-size:2.5em;margin-bottom:10px;display:block}
        .install-tabs{display:flex;gap:3px;background:var(--cream);padding:3px;border-radius:10px;margin-bottom:16px}
        .install-tab{flex:1;padding:8px 10px;border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-weight:600;font-size:.8em;cursor:pointer;background:transparent;color:var(--text-mid);transition:all .2s}
        .install-tab.active{background:var(--night);color:var(--gold-light)}
        .install-steps{text-align:left;margin-bottom:16px}
        .install-step{display:none;padding:0}
        .install-step.active{display:block}
        .install-step ol{margin:0;padding:0 0 0 20px;list-style:none;counter-reset:steps}
        .install-step ol li{counter-increment:steps;padding:10px 0;border-bottom:1px solid rgba(0,0,0,.06);font-size:.85em;color:var(--text-mid);line-height:1.5;position:relative;padding-left:32px}
        .install-step ol li:last-child{border:none}
        .install-step ol li::before{content:counter(steps);position:absolute;left:0;top:10px;width:24px;height:24px;background:var(--cream);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.75em;color:var(--night)}
        .install-step ol li strong{color:var(--night)}
        .install-step .step-icon{display:inline-block;background:var(--cream);padding:2px 6px;border-radius:4px;font-size:.9em}
        .install-close{width:100%;padding:12px;border-radius:10px;font-family:'DM Sans',sans-serif;font-weight:600;font-size:.88em;cursor:pointer;border:none;background:var(--night);color:var(--gold-light)}
        .install-close:active{transform:scale(.97)}
        @media(min-width:769px){
            .hero{padding:44px 24px 36px}
            .hero h1{font-size:2.8em}.hero-crescent{font-size:3.5em}.hero-ramadan{font-size:1.35em}
            .main-content{padding:28px 24px 50px}
            .today-card{padding:28px 26px}
            .today-top-row{margin-bottom:18px}
            .today-day-title{font-size:1.6em}
            .hero-time-box .ht-time{font-size:2.6em}
            .hero-time-box{padding:20px 14px}
            .prayer-pills{grid-template-columns:repeat(4,1fr)}.prayer-pill.pill-iftar{grid-column:1/-1}
            th{padding:13px 10px}td{padding:11px 10px}
        }
        @media(max-width:480px){.controls-row{flex-direction:column;gap:8px}.legend{justify-content:flex-start}}
    </style>
</head>
<body>
<div class="install-banner" id="installBanner" onclick="installApp()">üì± Install as app for quick access</div>
<div class="hero">
    <div class="hero-stars" id="heroStars"></div>
    <span class="hero-crescent">üåô</span>
    <h1 id="heroTitle">Hamilton Masjid</h1>
    <div class="hero-ramadan" id="heroRamadan">Ramadan 1447H ¬∑ ÿ±ŸÖÿ∂ÿßŸÜ ŸÉÿ±ŸäŸÖ</div>
    <div class="hero-info">
        <span>üìç Hamilton, NZ</span><span class="sep">¬∑</span>
        <span>üïå 921 Heaphy Terrace</span><span class="sep">¬∑</span>
        <span>Jumu'ah: <strong>1:40 PM</strong></span>
        <span class="sep" id="ramadanDateSep">¬∑</span>
        <span id="ramadanDateRange">üåô <strong>Feb 20 ‚Äì Mar 21</strong></span>
    </div>
</div>
<div class="main-content">
    <div class="today-card" id="todayCard">
        <div class="today-top-row">
            <div class="today-label" id="todayLabel">Today</div>
            <div class="today-day-title" id="todayDayTitle">Loading...</div>
            <div class="today-date-text" id="todayDateText"></div>
        </div>
        <div class="today-hero-times ramadan-only" id="suhoorIftarBoxes">
            <div class="hero-time-box suhoor-box"><div class="ht-label">Suhoor Ends</div><div class="ht-time" id="todaySuhoor">--:--</div><div class="ht-suffix">AM</div></div>
            <div class="hero-time-box iftar-box"><div class="ht-label">Break Fast</div><div class="ht-time" id="todayIftar">--:--</div><div class="ht-suffix">PM</div></div>
            <div class="hero-time-box fasting-box"><div class="ht-label">Fasting Today</div><div class="ht-time" id="todayFastingHrs">--</div><div class="ht-suffix" id="todayFastingMin">hours</div></div>
        </div>
        <div class="countdown-grid" id="countdownGrid">
            <div class="cd-box"><div class="cd-label">Next Prayer</div><div class="cd-value" id="cdNextPrayer">--:--</div><div class="cd-sub" id="cdNextName">...</div></div>
            <div class="cd-box cd-iftar" id="cdIftarBox"><div class="cd-label">Until Iftar</div><div class="cd-value" id="cdIftar">--:--</div><div class="cd-sub" id="cdIftarSub">...</div></div>
            <div class="cd-box" id="cdDayBox"><div class="cd-label">Ramadan Day</div><div class="cd-value" id="cdDay">--</div><div class="cd-sub">of 30</div></div>
        </div>
        <div class="special-notice" id="specialNotice"></div>
    </div>
    <div class="eid-info-cards" id="eidInfo">
        <div class="eid-card zakat-card">
            <span class="eid-icon">üí∞</span>
            <div><strong>Zakatul Fitr</strong> ‚Äî $15 per person<br><span class="eid-sub">Pay by March 15</span></div>
        </div>
        <div class="eid-card eid-salaat-card" id="eidSalaatCard">
            <span class="eid-icon">üïå</span>
            <div id="eidSalaatContent"><strong>Eid ul Fitr Salaat</strong> ‚Äî Claudelands Event Centre<br><span class="eid-sub">Date & time to be confirmed</span></div>
        </div>
    </div>
    <div class="controls-row">
        <div class="view-controls" id="viewControls">
            <button class="view-btn active" id="cardBtn" onclick="switchView('card')">Cards</button>
            <button class="view-btn" id="tableBtn" onclick="switchView('table')">Table</button>
        </div>
        <div class="legend" id="legendBar">
            <div class="legend-chip" onclick="scrollToDay('today')"><div class="legend-dot" style="background:var(--coral)"></div> Today</div>
            <div class="legend-chip" onclick="scrollToDay('last10')"><div class="legend-dot" style="background:var(--gold)"></div> Last 10</div>
            <div class="legend-chip" onclick="scrollToDay('odd')"><div class="legend-dot" style="background:#9b59b6"></div> Odd</div>
        </div>
    </div>
    <div class="card-view active" id="cardView"></div>
    <div class="table-view" id="tableView">
        <div class="table-wrapper desktop-table"><table><thead><tr id="desktopThead"></tr></thead><tbody id="tableBody"></tbody></table></div>
        <div class="table-wrapper mobile-table"><table><thead><tr id="mobileThead"></tr></thead><tbody id="mobileTableBody"></tbody></table></div>
    </div>
    <div class="action-row" id="calendarAction">
        <button class="action-pill ap-calendar" onclick="addToCalendar()"><span class="ap-icon">üìÖ</span> Calendar</button>
        <button class="action-pill ap-share" onclick="shareApp()"><span class="ap-icon">üì§</span> Share</button>
        <button class="action-pill ap-install" id="installBtn" onclick="handleInstall()"><span class="ap-icon">üì≤</span> Add to Home</button>
    </div>
    <!-- Notification Banner -->
    <div class="notif-banner" id="notifBanner" onclick="openNotifSettings()">
        <div class="nb-icon">üîî</div>
        <div class="nb-text">
            <div class="nb-title">Enable Prayer Notifications</div>
            <div class="nb-sub">Tap to get alerted before each prayer</div>
        </div>
        <div class="nb-arrow">‚Ä∫</div>
    </div>
    <div class="dua-cards" id="duaCards">
        <div class="dua-card"><h3>ü§≤ Suhoor Intention</h3><div class="dua-arabic">ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ŸÜŸéŸàŸéŸäŸíÿ™Ÿè ŸÑŸéŸÉŸé ÿµŸéŸàŸíŸÖŸé ÿ±ŸéŸÖŸéÿ∂ŸéÿßŸÜŸé</div><div class="dua-translit">Allahumma inni nawaytu laka sauma ramadhan</div><div class="dua-meaning">"Oh Allah! I intend to keep the fast of Ramadhan for Your pleasure"</div></div>
        <div class="dua-card"><h3>ü§≤ Iftar Dua</h3><div class="dua-arabic">ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ŸÑŸéŸÉŸé ÿµŸèŸÖŸíÿ™Ÿè ŸàŸéÿ®ŸêŸÉŸé ÿ¢ŸÖŸéŸÜŸíÿ™Ÿè ŸàŸéÿπŸéŸÑŸéŸâ ÿ±Ÿêÿ≤ŸíŸÇŸêŸÉŸé ÿ£ŸéŸÅŸíÿ∑Ÿéÿ±Ÿíÿ™Ÿè</div><div class="dua-translit">Allahumma inni laka sumtu wa bika aamantu wa ala rizq-ika-aftartu</div><div class="dua-meaning">"Oh Allah! I fasted for You and I believe in You and I break my fast with Your sustenance"</div></div>
    </div>
    <div class="info-section">
        <h4>üìå Important Information</h4>
        <ul class="info-list">
            <li><span class="li-icon">üïê</span> All prayer times shown are <strong>Iqama (congregation) times</strong></li>
            <li><span class="li-icon">üåô</span> Iftar times sourced from <strong>FIANZ calendar</strong></li>
            <li><span class="li-icon">üçΩÔ∏è</span> <strong>Suhoor Ends</strong> ‚Äî stop eating before Fajr adhan</li>
            <li><span class="li-icon">ü§≤</span> Taraweeh follows Isha prayer nightly</li>
            <li><span class="li-icon">üïå</span> Prayer times sourced from <strong>Waikato Muslim Association</strong></li>
        </ul>
    </div>
</div>
<div class="footer">
    <div class="footer-mubarak" id="footerMubarak">ÿ±ŸÖÿ∂ÿßŸÜ ŸÖÿ®ÿßÿ±ŸÉ</div>
    <div class="footer-dua" id="footerDua">May Allah accept our fasts ü§≤</div>
    <div class="footer-source">Source: FIANZ & Waikato Muslim Association</div>
</div>
<button class="scroll-top-btn" id="scrollTopBtn" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚Üë</button>
<div class="toast" id="toast"></div>

<!-- Notification Prompt -->
<div class="notif-overlay" id="notifOverlay">
    <div class="notif-modal">
        <span class="notif-icon">üîî</span>
        <h3>Prayer Reminders</h3>
        <p>Get notified before each prayer so you never miss Salaat</p>
        <div class="notif-options">
            <div class="notif-opt selected" onclick="toggleNotifOpt(this)" data-min="30">
                <div class="notif-check">‚úì</div>
                <div class="notif-opt-text">30 minutes before</div>
            </div>
            <div class="notif-opt" onclick="toggleNotifOpt(this)" data-min="20">
                <div class="notif-check">‚úì</div>
                <div class="notif-opt-text">20 minutes before</div>
            </div>
            <div class="notif-opt" onclick="toggleNotifOpt(this)" data-min="0">
                <div class="notif-check">‚úì</div>
                <div class="notif-opt-text">At prayer time</div>
            </div>
        </div>
        <div class="notif-btns">
            <button class="notif-btn secondary" onclick="closeNotifPrompt(false)">Not now</button>
            <button class="notif-btn primary" onclick="closeNotifPrompt(true)">Enable üîî</button>
        </div>
    </div>
</div>

<!-- Install Instructions Modal -->
<div class="install-overlay" id="installOverlay" onclick="if(event.target===this)this.classList.remove('show')">
    <div class="install-modal">
        <span class="im-icon">üì≤</span>
        <h3>Add to Home Screen</h3>
        <div class="install-tabs">
            <button class="install-tab active" onclick="switchInstallTab('safari',this)">Safari (iPhone)</button>
            <button class="install-tab" onclick="switchInstallTab('chrome',this)">Chrome (Android)</button>
        </div>
        <div class="install-steps">
            <div class="install-step active" id="installSafari">
                <ol>
                    <li>Tap the <strong>Share</strong> button <span class="step-icon">‚Üë</span> at the bottom of Safari</li>
                    <li>Scroll down and tap <strong>"Add to Home Screen"</strong></li>
                    <li>Tap <strong>"Add"</strong> in the top right corner</li>
                    <li>The app icon üåô will appear on your home screen!</li>
                </ol>
            </div>
            <div class="install-step" id="installChrome">
                <ol>
                    <li>Tap the <strong>three dots</strong> <span class="step-icon">‚ãÆ</span> menu in the top right</li>
                    <li>Tap <strong>"Add to Home screen"</strong> or <strong>"Install app"</strong></li>
                    <li>Tap <strong>"Add"</strong> to confirm</li>
                    <li>The app icon üåô will appear on your home screen!</li>
                </ol>
            </div>
        </div>
        <button class="install-close" onclick="document.getElementById('installOverlay').classList.remove('show')">Got it!</button>
    </div>
</div>

<script>
// Service Worker - register for PWA + clear old caches
if('serviceWorker' in navigator){
navigator.serviceWorker.getRegistrations().then(function(regs){
regs.forEach(function(r){r.unregister()});
setTimeout(function(){navigator.serviceWorker.register('sw.js')},500)
})}
if(window.caches){caches.keys().then(function(n){n.forEach(function(k){if(k!=='hamilton-masjid-v12')caches.delete(k)})})}

// PWA Install
var deferredPrompt;
window.addEventListener('beforeinstallprompt',function(e){e.preventDefault();deferredPrompt=e;document.getElementById('installBanner').classList.add('show')});
function installApp(){if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(function(){deferredPrompt=null;document.getElementById('installBanner').classList.remove('show')})}}
function handleInstall(){
if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(function(){deferredPrompt=null});return}
// Show instructions modal
var overlay=document.getElementById('installOverlay');
overlay.classList.add('show');
// Auto-select the right tab
var isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent);
if(isIOS){switchInstallTab('safari',document.querySelector('.install-tab'))}
else{var tabs=document.querySelectorAll('.install-tab');switchInstallTab('chrome',tabs[1])}
}
function switchInstallTab(tab,el){
document.querySelectorAll('.install-tab').forEach(function(t){t.classList.remove('active')});
document.querySelectorAll('.install-step').forEach(function(s){s.classList.remove('active')});
el.classList.add('active');
document.getElementById(tab==='safari'?'installSafari':'installChrome').classList.add('active')
}
// Hide install button if already standalone
if(window.matchMedia('(display-mode:standalone)').matches||window.navigator.standalone===true){var ib=document.getElementById('installBtn');if(ib)ib.style.display='none'}

// Stars
(function(){var c=document.getElementById('heroStars');for(var i=0;i<30;i++){var s=document.createElement('div');s.className='star';s.style.left=Math.random()*100+'%';s.style.top=Math.random()*100+'%';s.style.animationDelay=Math.random()*3+'s';var sz=(Math.random()*2+1)+'px';s.style.width=sz;s.style.height=sz;c.appendChild(s)}})();

function showToast(m){var t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(function(){t.classList.remove('show')},3500)}
function shareApp(){if(navigator.share){navigator.share({title:'Hamilton Masjid Prayer Times',text:'Ramadan prayer times for Hamilton Masjid',url:window.location.href})}else{navigator.clipboard.writeText(window.location.href);showToast('Link copied!')}}

// ‚ïê‚ïê‚ïê NOTIFICATION SYSTEM ‚ïê‚ïê‚ïê
function toggleNotifOpt(el){el.classList.toggle('selected')}
function openNotifSettings(){
document.getElementById('notifOverlay').classList.add('show');
}
function closeNotifPrompt(enable){
document.getElementById('notifOverlay').classList.remove('show');
localStorage.setItem('notifPromptShown','1');
if(enable&&'Notification' in window){
Notification.requestPermission().then(function(p){
if(p==='granted'){
var opts=document.querySelectorAll('.notif-opt.selected');
var mins=[];opts.forEach(function(o){mins.push(parseInt(o.dataset.min))});
localStorage.setItem('notifMins',JSON.stringify(mins));
showToast('üîî Prayer reminders enabled!');
updateNotifBanner(true);
scheduleNotifications()}
else{showToast('Notifications blocked by browser');updateNotifBanner(false)}})}}

function updateNotifBanner(enabled){
var banner=document.getElementById('notifBanner');
if(enabled){
banner.classList.add('nb-enabled');
var mins=JSON.parse(localStorage.getItem('notifMins')||'[]');
var labels=mins.map(function(m){return m===0?'at prayer time':m+' min before'});
banner.querySelector('.nb-title').textContent='Prayer Notifications On';
banner.querySelector('.nb-sub').textContent=labels.join(', ')||'Enabled';
banner.querySelector('.nb-icon').textContent='‚úÖ';
}else{
banner.classList.remove('nb-enabled');
banner.querySelector('.nb-title').textContent='Enable Prayer Notifications';
banner.querySelector('.nb-sub').textContent='Tap to get alerted before each prayer';
banner.querySelector('.nb-icon').textContent='üîî';
}}

function scheduleNotifications(){
var tp=getToday();if(!tp)return;
var mins=JSON.parse(localStorage.getItem('notifMins')||'[30]');
var prayers=[{n:'Fajr',t:tp.faj,am:true},{n:'Dhuhr',t:tp.dhu,am:false},{n:'Asr',t:tp.asr,am:false},{n:'Maghrib / Iftar',t:tp.mag,am:false},{n:'Isha',t:tp.ish,am:false}];
var now=new Date();
prayers.forEach(function(pr){
var pts=pr.t.split(':'),h=parseInt(pts[0]),m=parseInt(pts[1]);
if(!pr.am){if(h===1)h=13;else if(h>=4&&h<=10)h+=12}
mins.forEach(function(minBefore){
var notifTime=new Date(now.getFullYear(),now.getMonth(),now.getDate(),h,m-minBefore,0);
var delay=notifTime-now;
if(delay>0&&delay<86400000){
setTimeout(function(){
var body=minBefore>0?pr.n+' Iqama in '+minBefore+' minutes ('+pr.t+(pr.am?' AM':' PM')+')':pr.n+' Iqama time now! ('+pr.t+(pr.am?' AM':' PM')+')';
new Notification('üïå '+pr.n+(minBefore>0?' Soon':''),{body:body,icon:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üåô</text></svg>',badge:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üïå</text></svg>'})},delay)}})
})}

// Show notification prompt for first-time visitors
setTimeout(function(){
if(localStorage.getItem('notifMins')&&'Notification' in window&&Notification.permission==='granted'){
updateNotifBanner(true);scheduleNotifications()}
else{updateNotifBanner(false)}
},500);

// ‚ïê‚ïê‚ïê CORRECTED PRAYER DATA ‚ïê‚ïê‚ïê
var PT=[
{day:1,date:"Feb 20",wd:"Fri",suh:"5:14",faj:"5:40",sun:"6:53",dhu:"1:50",asr:"5:40",mag:"8:25",ift:"8:17",ish:"9:45"},
{day:2,date:"Feb 21",wd:"Sat",suh:"5:15",faj:"5:50",sun:"6:55",dhu:"1:50",asr:"5:40",mag:"8:25",ift:"8:15",ish:"9:40"},
{day:3,date:"Feb 22",wd:"Sun",suh:"5:17",faj:"5:50",sun:"6:56",dhu:"1:50",asr:"5:40",mag:"8:25",ift:"8:14",ish:"9:40"},
{day:4,date:"Feb 23",wd:"Mon",suh:"5:18",faj:"5:50",sun:"6:57",dhu:"1:50",asr:"5:40",mag:"8:20",ift:"8:13",ish:"9:40"},
{day:5,date:"Feb 24",wd:"Tue",suh:"5:20",faj:"5:50",sun:"6:58",dhu:"1:50",asr:"5:40",mag:"8:20",ift:"8:11",ish:"9:40"},
{day:6,date:"Feb 25",wd:"Wed",suh:"5:21",faj:"5:50",sun:"6:59",dhu:"1:50",asr:"5:40",mag:"8:20",ift:"8:10",ish:"9:40"},
{day:7,date:"Feb 26",wd:"Thu",suh:"5:22",faj:"5:50",sun:"7:00",dhu:"1:50",asr:"5:40",mag:"8:20",ift:"8:09",ish:"9:40"},
{day:8,date:"Feb 27",wd:"Fri",suh:"5:24",faj:"5:50",sun:"7:01",dhu:"1:50",asr:"5:40",mag:"8:20",ift:"8:07",ish:"9:30"},
{day:9,date:"Feb 28",wd:"Sat",suh:"5:25",faj:"5:50",sun:"7:02",dhu:"1:50",asr:"5:40",mag:"8:15",ift:"8:06",ish:"9:30"},
{day:10,date:"Mar 1",wd:"Sun",suh:"5:26",faj:"5:50",sun:"7:03",dhu:"1:50",asr:"5:20",mag:"8:15",ift:"8:04",ish:"9:30"},
{day:11,date:"Mar 2",wd:"Mon",suh:"5:28",faj:"6:00",sun:"7:04",dhu:"1:50",asr:"5:20",mag:"8:15",ift:"8:03",ish:"9:30"},
{day:12,date:"Mar 3",wd:"Tue",suh:"5:29",faj:"6:00",sun:"7:05",dhu:"1:50",asr:"5:20",mag:"8:10",ift:"8:02",ish:"9:30"},
{day:13,date:"Mar 4",wd:"Wed",suh:"5:30",faj:"6:00",sun:"7:06",dhu:"1:50",asr:"5:20",mag:"8:10",ift:"8:00",ish:"9:30"},
{day:14,date:"Mar 5",wd:"Thu",suh:"5:31",faj:"6:00",sun:"7:07",dhu:"1:50",asr:"5:20",mag:"8:10",ift:"7:59",ish:"9:20"},
{day:15,date:"Mar 6",wd:"Fri",suh:"5:33",faj:"6:00",sun:"7:08",dhu:"1:50",asr:"5:20",mag:"8:05",ift:"7:57",ish:"9:20"},
{day:16,date:"Mar 7",wd:"Sat",suh:"5:34",faj:"6:00",sun:"7:09",dhu:"1:50",asr:"5:20",mag:"8:05",ift:"7:56",ish:"9:20"},
{day:17,date:"Mar 8",wd:"Sun",suh:"5:35",faj:"6:00",sun:"7:10",dhu:"1:50",asr:"5:20",mag:"8:05",ift:"7:54",ish:"9:20"},
{day:18,date:"Mar 9",wd:"Mon",suh:"5:36",faj:"6:10",sun:"7:11",dhu:"1:50",asr:"5:20",mag:"8:05",ift:"7:53",ish:"9:20"},
{day:19,date:"Mar 10",wd:"Tue",suh:"5:37",faj:"6:10",sun:"7:12",dhu:"1:50",asr:"5:20",mag:"8:00",ift:"7:51",ish:"9:20"},
{day:20,date:"Mar 11",wd:"Wed",suh:"5:38",faj:"6:10",sun:"7:13",dhu:"1:50",asr:"5:20",mag:"8:00",ift:"7:50",ish:"9:10"},
{day:21,date:"Mar 12",wd:"Thu",suh:"5:40",faj:"6:10",sun:"7:14",dhu:"1:50",asr:"5:20",mag:"8:00",ift:"7:48",ish:"9:10"},
{day:22,date:"Mar 13",wd:"Fri",suh:"5:41",faj:"6:10",sun:"7:15",dhu:"1:50",asr:"5:10",mag:"7:55",ift:"7:47",ish:"9:10"},
{day:23,date:"Mar 14",wd:"Sat",suh:"5:42",faj:"6:10",sun:"7:16",dhu:"1:50",asr:"5:10",mag:"7:55",ift:"7:45",ish:"9:10"},
{day:24,date:"Mar 15",wd:"Sun",suh:"5:43",faj:"6:10",sun:"7:17",dhu:"1:50",asr:"5:10",mag:"7:55",ift:"7:44",ish:"9:10"},
{day:25,date:"Mar 16",wd:"Mon",suh:"5:44",faj:"6:10",sun:"7:18",dhu:"1:50",asr:"5:10",mag:"7:50",ift:"7:43",ish:"9:10"},
{day:26,date:"Mar 17",wd:"Tue",suh:"5:45",faj:"6:10",sun:"7:18",dhu:"1:50",asr:"5:10",mag:"7:50",ift:"7:41",ish:"9:00"},
{day:27,date:"Mar 18",wd:"Wed",suh:"5:46",faj:"6:20",sun:"7:19",dhu:"1:50",asr:"5:10",mag:"7:50",ift:"7:40",ish:"9:00"},
{day:28,date:"Mar 19",wd:"Thu",suh:"5:47",faj:"6:20",sun:"7:20",dhu:"1:50",asr:"5:10",mag:"7:50",ift:"7:38",ish:"9:00"},
{day:29,date:"Mar 20",wd:"Fri",suh:"5:48",faj:"6:20",sun:"7:21",dhu:"1:50",asr:"5:10",mag:"7:45",ift:"7:36",ish:"9:00"},
{day:30,date:"Mar 21",wd:"Sat",suh:"5:49",faj:"6:20",sun:"7:22",dhu:"1:50",asr:"5:10",mag:"7:45",ift:"7:33",ish:"9:00"}
];

var RAMADAN_START=new Date(2026,1,20),RAMADAN_END=new Date(2026,2,21);
function isRamadan(){var now=new Date();var today=new Date(now.getFullYear(),now.getMonth(),now.getDate());return today>=RAMADAN_START&&today<=RAMADAN_END}
function applyMode(){
var ram=isRamadan();
document.getElementById('heroTitle').textContent=ram?'Ramadan 1447H':'Hamilton Masjid';
document.getElementById('heroRamadan').classList.toggle('hide',!ram);
document.getElementById('ramadanDateRange').style.display=ram?'':'none';
document.getElementById('ramadanDateSep').style.display=ram?'':'none';
document.getElementById('suhoorIftarBoxes').classList.toggle('hide',!ram);
document.getElementById('cdIftarBox').style.display=ram?'':'none';
document.getElementById('cdDayBox').style.display=ram?'':'none';
document.getElementById('countdownGrid').classList.toggle('normal-mode',!ram);
document.getElementById('legendBar').style.display=ram?'':'none';
document.getElementById('calendarAction').style.display=ram?'':'none';
document.getElementById('viewControls').style.display=ram?'':'none';
document.getElementById('duaCards').style.display=ram?'':'none';
document.getElementById('eidInfo').style.display=ram?'':'none';
document.getElementById('footerMubarak').textContent=ram?'ÿ±ŸÖÿ∂ÿßŸÜ ŸÖÿ®ÿßÿ±ŸÉ':'Hamilton Masjid';
document.getElementById('footerDua').textContent=ram?'May Allah accept our fasts ü§≤':'Prayer Times';
document.getElementById('cardView').style.display=ram?'':'none';
document.getElementById('tableView').style.display=ram?'':'none'}

function pad(n){return n<10?'0'+n:''+n}
function icsTime(ds,h,m){return'DTSTART;TZID=Pacific/Auckland:'+ds+'T'+pad(h)+pad(m)+'00'}
function icsEnd(ds,h,m,dur){var em=m+dur,eh=h;while(em>=60){eh++;em-=60}return'DTEND;TZID=Pacific/Auckland:'+ds+'T'+pad(eh)+pad(em)+'00'}
function icsEvent(ds,h,m,dur,summary,desc,uid,alarmMin){return['BEGIN:VEVENT',icsTime(ds,h,m),icsEnd(ds,h,m,dur),'SUMMARY:'+summary,'DESCRIPTION:'+desc,'LOCATION:Hamilton Masjid\\, 921 Heaphy Terrace\\, Hamilton','BEGIN:VALARM','TRIGGER:-PT'+alarmMin+'M','ACTION:DISPLAY','DESCRIPTION:'+summary+' in '+alarmMin+' minutes','END:VALARM','UID:'+uid,'END:VEVENT']}
function generateICSContent(){
var L=['BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//Ramadan Hamilton 2026//EN','CALSCALE:GREGORIAN','METHOD:PUBLISH','X-WR-CALNAME:Ramadan 2026 Hamilton','X-WR-TIMEZONE:Pacific/Auckland'];
PT.forEach(function(p){var mo=p.date.includes('Feb')?'02':'03';var dy=p.date.split(' ')[1];if(dy.length<2)dy='0'+dy;var ds='2026'+mo+dy;var d=p.day;
var ss=p.suh.split(':');L.push.apply(L,icsEvent(ds,parseInt(ss[0]),Math.max(parseInt(ss[1])-15,0),15,'Suhoor Ends - Ramadan Day '+d,'Stop eating by '+p.suh+' AM','suhoor-'+d+'-1447@ramadan-hamilton',10));
var fs=p.faj.split(':');L.push.apply(L,icsEvent(ds,parseInt(fs[0]),parseInt(fs[1]),20,'Fajr Iqama','Fajr at '+p.faj+' AM','fajr-'+d+'-1447@ramadan-hamilton',10));
var dhs=p.dhu.split(':');L.push.apply(L,icsEvent(ds,parseInt(dhs[0])+12,parseInt(dhs[1]),20,'Dhuhr Iqama','Dhuhr at '+p.dhu+' PM','dhuhr-'+d+'-1447@ramadan-hamilton',10));
var as=p.asr.split(':');L.push.apply(L,icsEvent(ds,parseInt(as[0])+12,parseInt(as[1]),20,'Asr Iqama','Asr at '+p.asr+' PM','asr-'+d+'-1447@ramadan-hamilton',10));
var ms=p.mag.split(':');L.push.apply(L,icsEvent(ds,parseInt(ms[0])+12,parseInt(ms[1]),20,'Maghrib Iqama','Maghrib at '+p.mag+' PM','maghrib-'+d+'-1447@ramadan-hamilton',10));
var is2=p.ift.split(':');L.push.apply(L,icsEvent(ds,parseInt(is2[0])+12,parseInt(is2[1]),30,'üåô Iftar - Ramadan Day '+d,'Break fast at '+p.ift+' PM','iftar-'+d+'-1447@ramadan-hamilton',15));
var es=p.ish.split(':');L.push.apply(L,icsEvent(ds,parseInt(es[0])+12,parseInt(es[1]),20,'Isha Iqama','Isha at '+p.ish+' PM. Taraweeh follows.','isha-'+d+'-1447@ramadan-hamilton',10));
});L.push('END:VCALENDAR');return L.join('\r\n')}
function addToCalendar(){var ics=generateICSContent();if(/iPad|iPhone|iPod/.test(navigator.userAgent)){window.location.href='data:text/calendar;charset=utf-8,'+encodeURIComponent(ics)}else{var b=new Blob([ics],{type:'text/calendar;charset=utf-8'});var u=URL.createObjectURL(b);var a=document.createElement('a');a.href=u;a.download='ramadan-hamilton-2026.ics';document.body.appendChild(a);a.click();setTimeout(function(){document.body.removeChild(a);URL.revokeObjectURL(u)},200);showToast('üìÖ Tap the downloaded file to add to calendar')}}

function parseTime(t,n){var p=t.split(':'),h=parseInt(p[0]),m=parseInt(p[1]);if(n!=='Fajr'&&n!=='Sunrise'&&n!=='suhoor'){if(h===1)h=13;else if(h>=4&&h<=10)h+=12}var now=new Date();return new Date(now.getFullYear(),now.getMonth(),now.getDate(),h,m,0)}
function getToday(){var now=new Date();for(var i=0;i<PT.length;i++){var p=PT[i];var d=new Date(2026,p.date.includes('Feb')?1:2,parseInt(p.date.split(' ')[1]));if(d.toDateString()===now.toDateString())return p}return null}
function isToday(p){var now=new Date();var d=new Date(2026,p.date.includes('Feb')?1:2,parseInt(p.date.split(' ')[1]));return d.toDateString()===now.toDateString()}
function switchView(v){document.getElementById('cardBtn').classList.toggle('active',v==='card');document.getElementById('tableBtn').classList.toggle('active',v==='table');document.getElementById('cardView').classList.toggle('active',v==='card');document.getElementById('tableView').classList.toggle('active',v==='table')}
function rowClasses(p){var c='';if(isToday(p))c+=' row-today';if(p.day>=21)c+=' row-last-ten';if([23,25,27,29].indexOf(p.day)!==-1)c+=' row-odd';if(p.day===15)c+=' row-halfway';return c}
function dayMarker(d){if(d===1)return' üåü';if(d===15)return' üéâ';if(d===27)return' ‚ú®';if(d===30)return' üéä';return''}
function scrollToDay(target){var dayNum;if(target==='today'){var tp=getToday();dayNum=tp?tp.day:1}else if(target==='last10'){dayNum=21}else if(target==='odd'){dayNum=23}else if(target==='halfway'){dayNum=15}var allEls=document.querySelectorAll('[data-day="'+dayNum+'"]');var el=null;for(var i=0;i<allEls.length;i++){if(allEls[i].offsetParent!==null){el=allEls[i];break}}if(!el)return;window.scrollTo({top:el.getBoundingClientRect().top+window.pageYOffset-80,behavior:'smooth'});el.style.transition='box-shadow .3s,outline .3s';el.style.boxShadow='0 0 0 3px var(--gold),0 4px 24px rgba(212,168,67,.3)';el.style.outline='2px solid #d4a843';setTimeout(function(){el.style.boxShadow='';el.style.outline=''},2500)}
function buildHeaders(){var ram=isRamadan();document.getElementById('desktopThead').innerHTML=ram?'<th>Day</th><th>Date</th><th class="th-suhoor">Suhoor<br>Ends</th><th>Fajr <span class="th-sub">Iqama</span></th><th>Dhuhr <span class="th-sub">Iqama</span></th><th>Asr <span class="th-sub">Iqama</span></th><th>Maghrib <span class="th-sub">Iqama</span></th><th class="th-iftar">Iftar</th><th>Isha <span class="th-sub">Iqama</span></th>':'<th>Date</th><th>Fajr</th><th>Sunrise</th><th>Dhuhr</th><th>Asr</th><th>Maghrib</th><th>Isha</th>';document.getElementById('mobileThead').innerHTML=ram?'<th>Day</th><th class="th-suhoor">Suh<br>Ends</th><th>Fajr</th><th>Dhuhr</th><th>Asr</th><th>Mag</th><th class="th-iftar">Iftar</th><th>Isha</th>':'<th>Date</th><th>Fajr</th><th>Dhuhr</th><th>Asr</th><th>Mag</th><th>Isha</th>'}
function populateCards(){var c=document.getElementById('cardView');var ram=isRamadan();PT.forEach(function(p){var iT=isToday(p),isO=[23,25,27,29].indexOf(p.day)!==-1,isL=p.day>=21;var cls='day-card';if(iT)cls+=' is-today';if(isO)cls+=' is-odd';if(isL)cls+=' is-last-ten';var d=document.createElement('div');d.className=cls;d.setAttribute('data-day',p.day);var sP=ram?'<div class="prayer-pill pill-suhoor"><div class="pp-name">Suhoor Ends</div><div class="pp-time">'+p.suh+' AM</div></div>':'';var iP=ram?'<div class="prayer-pill pill-iftar"><div class="pp-name">üåô Iftar Time</div><div class="pp-time">'+p.ift+' PM</div></div>':'';var iQ=ram?'<div class="card-iftar-quick"><div class="ciq-label">Iftar</div><div class="ciq-time">'+p.ift+'</div></div>':'<div class="card-iftar-quick"><div class="ciq-label">Maghrib</div><div class="ciq-time">'+p.mag+'</div></div>';d.innerHTML='<div class="card-header" onclick="this.parentElement.classList.toggle(\'expanded\')"><div class="card-header-left"><div class="card-day-num">'+p.day+'</div><div class="card-header-info"><div class="card-title">Day '+p.day+dayMarker(p.day)+'</div><div class="card-subtitle">'+p.wd+', '+p.date+'</div></div></div><div style="display:flex;align-items:center">'+iQ+'<span class="chevron">‚ñº</span></div></div><div class="card-body"><div class="prayer-pills">'+sP+'<div class="prayer-pill"><div class="pp-name">Fajr</div><div class="pp-time">'+p.faj+' AM</div></div><div class="prayer-pill"><div class="pp-name">Sunrise</div><div class="pp-time">'+p.sun+' AM</div></div><div class="prayer-pill"><div class="pp-name">Dhuhr</div><div class="pp-time">'+p.dhu+' PM</div></div><div class="prayer-pill"><div class="pp-name">Asr</div><div class="pp-time">'+p.asr+' PM</div></div><div class="prayer-pill"><div class="pp-name">Maghrib</div><div class="pp-time">'+p.mag+' PM</div></div><div class="prayer-pill"><div class="pp-name">Isha</div><div class="pp-time">'+p.ish+' PM</div></div>'+iP+'</div></div>';c.appendChild(d)})}
function populateDesktopTable(){var tb=document.getElementById('tableBody');var ram=isRamadan();PT.forEach(function(p){var r=document.createElement('tr');r.className=rowClasses(p);r.setAttribute('data-day',p.day);r.innerHTML=ram?'<td class="td-day">'+p.day+dayMarker(p.day)+'</td><td><strong>'+p.date+'</strong></td><td class="td-suhoor">'+p.suh+' <small>AM</small></td><td>'+p.faj+' <small>AM</small></td><td>'+p.dhu+' <small>PM</small></td><td>'+p.asr+' <small>PM</small></td><td>'+p.mag+' <small>PM</small></td><td class="td-iftar">'+p.ift+' <small>PM</small></td><td>'+p.ish+' <small>PM</small></td>':'<td><strong>'+p.date+'</strong></td><td>'+p.faj+'</td><td>'+p.sun+'</td><td>'+p.dhu+'</td><td>'+p.asr+'</td><td>'+p.mag+'</td><td>'+p.ish+'</td>';tb.appendChild(r)})}
function populateMobileTable(){var tb=document.getElementById('mobileTableBody');var ram=isRamadan();PT.forEach(function(p){var iT=isToday(p);var r=document.createElement('tr');r.className=rowClasses(p);r.setAttribute('data-day',p.day);r.innerHTML=ram?'<td class="td-day">'+p.day+'<span class="mob-date">'+p.wd.substring(0,2)+'</span></td><td class="td-suhoor">'+p.suh+'<small>am</small></td><td>'+p.faj+'<small>am</small></td><td>'+p.dhu+'<small>pm</small></td><td>'+p.asr+'<small>pm</small></td><td>'+p.mag+'<small>pm</small></td><td class="td-iftar">'+p.ift+'<small>pm</small></td><td>'+p.ish+'<small>pm</small></td>':'<td class="td-day">'+p.date+'<span class="mob-date">'+p.wd.substring(0,2)+'</span></td><td>'+p.faj+'</td><td>'+p.dhu+'</td><td>'+p.asr+'</td><td>'+p.mag+'</td><td>'+p.ish+'</td>';tb.appendChild(r);if(iT&&ram){var dr=document.createElement('tr');dr.className='today-detail-row';dr.innerHTML='<td colspan="8"><div class="today-detail-card"><div class="tdc-title">üìç Today ‚Äî Day '+p.day+' ‚Äî '+p.wd+', '+p.date+'</div><div class="tdc-grid"><div class="tdc-item tdc-suhoor"><div class="tdc-label">Suhoor</div><div class="tdc-time">'+p.suh+' AM</div></div><div class="tdc-item"><div class="tdc-label">Fajr</div><div class="tdc-time">'+p.faj+' AM</div></div><div class="tdc-item"><div class="tdc-label">Sunrise</div><div class="tdc-time">'+p.sun+' AM</div></div><div class="tdc-item"><div class="tdc-label">Dhuhr</div><div class="tdc-time">'+p.dhu+' PM</div></div><div class="tdc-item"><div class="tdc-label">Asr</div><div class="tdc-time">'+p.asr+' PM</div></div><div class="tdc-item"><div class="tdc-label">Maghrib</div><div class="tdc-time">'+p.mag+' PM</div></div><div class="tdc-item tdc-iftar"><div class="tdc-label">üåô Iftar</div><div class="tdc-time">'+p.ift+' PM</div></div><div class="tdc-item"><div class="tdc-label">Isha</div><div class="tdc-time">'+p.ish+' PM</div></div></div></div></td>';tb.appendChild(dr)}})}
function updateCountdowns(){var now=new Date(),tp=getToday(),ram=isRamadan();if(!tp){document.getElementById('todayDayTitle').textContent=ram?'Ramadan not active today':'Prayer Times';document.getElementById('todayDateText').textContent=new Date().toLocaleDateString('en-NZ',{weekday:'long',day:'numeric',month:'long',year:'numeric'});return}
document.getElementById('todayDayTitle').textContent=ram?'Day '+tp.day+' of Ramadan':'Prayer Times';document.getElementById('todayDateText').textContent=tp.wd+', '+tp.date+' 2026';
if(ram){document.getElementById('todaySuhoor').textContent=tp.suh;document.getElementById('todayIftar').textContent=tp.ift;document.getElementById('cdDay').textContent=tp.day;
var sP2=tp.suh.split(':'),iP2=tp.ift.split(':'),totalMin=(parseInt(iP2[0])+12)*60+parseInt(iP2[1])-(parseInt(sP2[0])*60+parseInt(sP2[1]));
document.getElementById('todayFastingHrs').textContent=Math.floor(totalMin/60)+'h '+(totalMin%60)+'m';document.getElementById('todayFastingMin').textContent='total fast'}
var notice=document.getElementById('specialNotice');if(ram){if(tp.day===1){notice.textContent='üåü First day of Ramadan!';notice.classList.add('show')}else if(tp.day===15){notice.textContent='üéâ Halfway through Ramadan!';notice.classList.add('show')}else if(tp.day===27){notice.textContent='‚ú® Laylatul Qadr ‚Äî most likely night!';notice.classList.add('show')}else if([23,25,29].indexOf(tp.day)!==-1){notice.textContent='‚ú® Odd night ‚Äî seek Laylatul Qadr';notice.classList.add('show')}else if(tp.day>=21){notice.textContent='üåô Last 10 nights ‚Äî increase worship';notice.classList.add('show')}}
document.getElementById('todayLabel').textContent=ram?(tp.day>=21?'Last 10 Nights ‚Äî Day '+tp.day:'Day '+tp.day+' of 30'):'Today';
var prayers=[{name:'Fajr',time:tp.faj},{name:'Dhuhr',time:tp.dhu},{name:'Asr',time:tp.asr},{name:'Maghrib',time:tp.mag},{name:'Isha',time:tp.ish}];var next=null;
for(var i=0;i<prayers.length;i++){var pt=parseTime(prayers[i].time,prayers[i].name);if(pt>now){next={name:prayers[i].name,time:prayers[i].time,dt:pt};break}}
if(!next&&tp.day<30){var tm=PT[tp.day];if(tm){var ft=parseTime(tm.faj,'Fajr');ft.setDate(ft.getDate()+1);next={name:'Fajr (tmrw)',time:tm.faj,dt:ft}}}
if(next){var diff=next.dt-now;if(diff>0){var h=Math.floor(diff/3600000),m=Math.floor((diff%3600000)/60000),s=Math.floor((diff%60000)/1000);document.getElementById('cdNextPrayer').textContent=pad(h)+':'+pad(m)+':'+pad(s);document.getElementById('cdNextName').textContent=next.name+' at '+next.time+((next.name==='Fajr'||next.name.indexOf('Fajr')!==-1)?' AM':' PM')}}
else{document.getElementById('cdNextPrayer').textContent='‚úÖ';document.getElementById('cdNextName').textContent='All prayers done'}
if(ram){var ift=parseTime(tp.ift,'Iftar'),id=ift-now;if(id>0){var h2=Math.floor(id/3600000),m2=Math.floor((id%3600000)/60000),s2=Math.floor((id%60000)/1000);document.getElementById('cdIftar').textContent=pad(h2)+':'+pad(m2)+':'+pad(s2);document.getElementById('cdIftarSub').textContent='at '+tp.ift+' PM'}else{document.getElementById('cdIftar').textContent='‚úÖ';document.getElementById('cdIftarSub').textContent='Iftar time passed'}}}
window.addEventListener('scroll',function(){document.getElementById('scrollTopBtn').classList.toggle('show',window.scrollY>300)});
applyMode();buildHeaders();populateCards();populateDesktopTable();populateMobileTable();
if(window.innerWidth<769)switchView('card');else switchView('table');
updateCountdowns();setInterval(updateCountdowns,1000);

// Load Eid config if available
(function(){try{fetch('eid-config.json?t='+Date.now()).then(function(r){if(r.ok)return r.json();throw''}).then(function(cfg){
if(cfg&&cfg.location){var h='<strong>Eid ul Fitr Salaat</strong>';
h+=' ‚Äî '+cfg.location;
var sub=[];
if(cfg.date)sub.push(cfg.date);
if(cfg.time)sub.push(cfg.time);
if(cfg.parking)sub.push('üÖøÔ∏è '+cfg.parking);
if(sub.length)h+='<br><span class="eid-sub">'+sub.join(' ¬∑ ')+'</span>';
else h+='<br><span class="eid-sub">Details to be confirmed</span>';
document.getElementById('eidSalaatContent').innerHTML=h}
}).catch(function(){})}catch(e){}})();

// Load Ramadan config ‚Äî can shorten to 29 days based on moon sighting
(function(){try{fetch('ramadan-config.json?t='+Date.now()).then(function(r){if(r.ok)return r.json();throw''}).then(function(cfg){
if(!cfg)return;
var changed=false;
// Shorten to 29 days if moon sighted early
if(cfg.totalDays&&cfg.totalDays===29&&PT.length>29){
PT.length=29;changed=true;
}
// Update end date
if(cfg.endDate){
var ep=cfg.endDate.split('-');
RAMADAN_END=new Date(parseInt(ep[0]),parseInt(ep[1])-1,parseInt(ep[2]));
changed=true;
}
if(changed){
document.getElementById('cardView').innerHTML='';
document.getElementById('tableBody').innerHTML='';
document.getElementById('mobileTableBody').innerHTML='';
applyMode();buildHeaders();populateCards();populateDesktopTable();populateMobileTable();updateCountdowns();
}
}).catch(function(){})}catch(e){}})();
</script>
</body>
</html>
